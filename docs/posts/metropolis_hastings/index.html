<!DOCTYPE html>
<html lang="jp">

<head><title>
    メトロポリス法ってなんだし。 | 
    
    TH&#39;s Blog</title>

<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
<meta name="description" content="本記事では，マルコフ連鎖モンテカルロ法（Markov Chain Monte Carlo: MCMC）を実現する手法の１つである，メトロポリス法（Metropolis-Hastings Method）について解説してみます．また，数値実験を行います．
    ">


<meta property="og:title" content="メトロポリス法ってなんだし。" />
<meta property="og:description" content="本記事では，マルコフ連鎖モンテカルロ法（Markov Chain Monte Carlo: MCMC）を実現する手法の１つである，メトロポリス法（Metropolis-Hastings Method）について解説してみます．また，数値実験を行います．" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://example.com/posts/metropolis_hastings/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-01-24T00:00:00+00:00" />
<meta property="article:modified_time" content="2022-01-24T00:00:00+00:00" />


<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="メトロポリス法ってなんだし。"/>
<meta name="twitter:description" content="本記事では，マルコフ連鎖モンテカルロ法（Markov Chain Monte Carlo: MCMC）を実現する手法の１つである，メトロポリス法（Metropolis-Hastings Method）について解説してみます．また，数値実験を行います．"/>

<meta itemprop="name" content="メトロポリス法ってなんだし。">
<meta itemprop="description" content="本記事では，マルコフ連鎖モンテカルロ法（Markov Chain Monte Carlo: MCMC）を実現する手法の１つである，メトロポリス法（Metropolis-Hastings Method）について解説してみます．また，数値実験を行います．"><meta itemprop="datePublished" content="2022-01-24T00:00:00+00:00" />
<meta itemprop="dateModified" content="2022-01-24T00:00:00+00:00" />
<meta itemprop="wordCount" content="438">
<meta itemprop="keywords" content="Bayesian Inference,Machine Learning,MCMC,Metropolis-Hastings," />
<link rel="canonical" href="https://example.com/posts/metropolis_hastings/" />

<link rel="icon" type="image/png" href="https://example.comimage/favicon.ico">

<link rel="stylesheet" href="/css/font-awesome.min.css">
<link rel="stylesheet" href="/css/bulma.min.css">





<script src=/js/ramium.js></script>
<link rel="stylesheet" href=/css/ramium.css>




<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css"
    integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js"
    integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz"
    crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js"
    integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"
    onload="renderMathInElement(document.body);"></script>
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            renderMathInElement(document.body, {
              
              
              delimiters: [
                  {left: '$$', right: '$$', display: true},
                  {left: '$', right: '$', display: false},
                  {left: '\\(', right: '\\)', display: false},
                  {left: '\\[', right: '\\]', display: true}
              ],
              
              throwOnError : false
            });
        });
    </script>


</head>

<body><nav class="navbar is-dark" role="navigation" aria-label="main navigation">
  <div class="navbar-brand">
    <a class="navbar-item" href=/>
      
      <strong>TH&#39;s Blog </strong>
      
    </a>

    <a role="button" class="navbar-burger burger" aria-label="menu" aria-expanded="false"
      data-target="navbarBasicExample">
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
    </a>
  </div>

  <div id="navbarBasicExample" class="navbar-menu">
    <div class="navbar-start">
      
      
      <a class="navbar-item" href="/">Home</a>
      
      
      
      <div class="navbar-item has-dropdown is-hoverable">
        <a class="navbar-link">This Blog</a>
        <div class="navbar-dropdown">
          
          <a class="navbar-item" href="/tags/">All Tags</a>
          
          <a class="navbar-item" href="/sections/">All Sections</a>
          
          <a class="navbar-item" href="/posts/">All Posts</a>
          
        </div>
      </div>
      
      
      
      <a class="navbar-item" href="/author/">Author</a>
      
      
    </div>

    <div class="navbar-end">
      
      <a class="navbar-item navgithub" href="https://github.com/rafed/ramium/" target="_blank">
        <i class="fa fa-github fa-2x"></i>
      </a>
      

      
    </div>
  </div>
</nav><div class="columns is-centered">
        <div id="page-body" class="column is-7">

<div class="content blog">
    <h1>メトロポリス法ってなんだし。</h1>

    <div id="infobar" class="level is-mobile">
        <div class="level-left">
            
            <div class="level-item">
                <p class="subtitle info date">Jan 24, 2022
                </p>
            </div>
            

            <div class="level-item">
                <p class="subtitle info">
                    12 mins read
                </p>
            </div>
        </div>
        <div class="level-right is-hidden-touch">
            <div class="tags">
                
                <a class="tag is-dark is-rounded" href="/tags/bayesian-inference">Bayesian Inference</a>
                
                <a class="tag is-dark is-rounded" href="/tags/machine-learning">Machine Learning</a>
                
                <a class="tag is-dark is-rounded" href="/tags/mcmc">MCMC</a>
                
                <a class="tag is-dark is-rounded" href="/tags/metropolis-hastings">Metropolis-Hastings</a>
                
            </div>
        </div>
    </div>

    <div class="tags is-hidden-desktop">
        
        <a class="tag is-dark is-rounded" href="/tags/bayesian-inference">Bayesian inference</a>
        
        <a class="tag is-dark is-rounded" href="/tags/machine-learning">Machine learning</a>
        
        <a class="tag is-dark is-rounded" href="/tags/mcmc">MC MC</a>
        
        <a class="tag is-dark is-rounded" href="/tags/metropolis-hastings">Metropolis hastings</a>
        
    </div>

    <div class="blog-text">
        
        <figure>
            <img src="/image/profile.jpg">
        </figure>
        

        <p>本記事では，マルコフ連鎖モンテカルロ法（Markov Chain Monte Carlo: MCMC）を実現する手法の１つである，メトロポリス法（Metropolis-Hastings Method）について解説してみます．
また，簡単 of 簡単な数値実験を行います．</p>
<h2 id="メトロポリス法metropolis-hastings-method">メトロポリス法(Metropolis-Hastings Method)</h2>
<h2 id="数値実験">数値実験</h2>
<p>今回はメトロポリス法による1次元標準正規分布からのサンプリングを行います．
確率変数を $x\in\mathbb R$ とします．
標準正規分布の確率密度関数 $p(x)$ は</p>
<p>$$
p(x|\mu = 0, \sigma^2 = 1) = \frac{1}{\sqrt{2\pi}}\exp\left(-\frac{1}{2}x^2\right),
$$</p>
<p>となります．
現時点でのサンプルを $x$ とし，確率的摂動 $\delta\in\mathbb R$ を加えた，遷移先の候補点を $x' = x + \delta$とします．
メトロポリス法の更新則として，$x,x'$ を用いて</p>
<p>$$
u = \min\left\{1, \frac{p(x')}{p(x)}\right\} = \min\left\{1, \frac{\exp(-x^2/2)}{\exp(-x'^2/2)}\right\}
$$</p>
<p>を計算し，これを遷移の採択確率とすれば良いです．
実際の計算においては，対数をとり，</p>
<p>$$
\log u = \min\left\{0, \frac{1}{2}(x^2 - x'^2)\right\}
$$</p>
<p>を用いて計算すると実装が簡単になりますので，本記事ではこちらを用います．</p>
<p>MCMCにおいて，定常分布に落ち着くまで少し時間が必要であるため，最初にMCMCでのサンプリングを回しておく必要があります．
運動前のウォームアップのようなもので，<strong>バーンイン</strong>と呼ばれます．
このバーンイン期間に得られたサンプルは，通常，確率分布から得られたサンプルとは見做さずに捨ててしまいます．
バーンインのサンプル数をどのように決定するべきかという問題には未だ明確な解決策が示されていません．
この記事では，バーンインのサンプル数を $40,000$ としています．
バーンイン後に，$40,000$ サンプルを取得しました．</p>
<p>本実験に使用したコードを以下に掲載します．
コードには自作のライブラリ <code>numpy.hpp</code>（C++のvectorをPython の Numpy 形式で保存する関数群）と <code>xoshiro.h</code> （メルセンヌ・ツイスタよりも早い乱数生成エンジンのテンプレート）を使用しておりますが，これらについてはそれぞれ，<a href="../c++2npy">C++配列を.npy形式で保存したい癖の強いあなたへ。</a>と<a href="../xorshiro">XorShiftという乱数生成法が早いらしい。</a>という別記事を参照していただけると幸いです．</p>
<details>
<summary>main.cpp</summary>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C++:main.cpp" data-lang="C++:main.cpp"><span style="color:#75715e">#include</span><span style="color:#75715e">&lt;bits/stdc++.h&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e">#include</span><span style="color:#75715e">&#34;include/numpy.hpp&#34; //C++ vector を .npy 形式で保存するためのライブラリ</span><span style="color:#75715e">
</span><span style="color:#75715e">#include</span><span style="color:#75715e">&#34;include/xoshiro.h&#34; //乱数生成エンジンのライブラリ</span><span style="color:#75715e">
</span><span style="color:#75715e"></span>
<span style="color:#66d9ef">using</span> <span style="color:#66d9ef">namespace</span> std;
<span style="color:#66d9ef">using</span> rng_type <span style="color:#f92672">=</span> xoshiro<span style="color:#f92672">::</span>rng128pp;

<span style="color:#66d9ef">const</span> <span style="color:#66d9ef">int</span> BURNIN_NUM <span style="color:#f92672">=</span> <span style="color:#ae81ff">40000</span>; <span style="color:#75715e">//バーンイン数
</span><span style="color:#75715e"></span><span style="color:#66d9ef">const</span> <span style="color:#66d9ef">int</span> SAMPLE_NUM <span style="color:#f92672">=</span> <span style="color:#ae81ff">40000</span>; <span style="color:#75715e">//サンプリング数
</span><span style="color:#75715e"></span><span style="color:#66d9ef">const</span> <span style="color:#66d9ef">int</span> seed <span style="color:#f92672">=</span> <span style="color:#ae81ff">2021</span>; <span style="color:#75715e">//乱数シード
</span><span style="color:#75715e"></span>
<span style="color:#75715e">/** ２乗を返す関数 */</span>
<span style="color:#66d9ef">inline</span> <span style="color:#66d9ef">float</span> <span style="color:#a6e22e">pow2</span>(<span style="color:#66d9ef">float</span> x){
    <span style="color:#66d9ef">return</span> x <span style="color:#f92672">*</span> x;
}

<span style="color:#75715e">/** 実験結果を保持する構造体 */</span>
<span style="color:#66d9ef">struct</span> <span style="color:#a6e22e">Result</span>{
    
    <span style="color:#75715e">//MCMCで得られたサンプルを格納するvector
</span><span style="color:#75715e"></span>    vector<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">float</span><span style="color:#f92672">&gt;</span>sample;

    Result(){
        sample <span style="color:#f92672">=</span> vector<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">float</span><span style="color:#f92672">&gt;</span>(SAMPLE_NUM);
    }

    <span style="color:#75715e">//sampleを保存
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">dump</span>(){
        SaveNpy(<span style="color:#e6db74">&#34;result/sample.npy&#34;</span>, sample);
    }
};

<span style="color:#75715e">/** Metropolis-Hastings法 の構造体 */</span>
<span style="color:#66d9ef">struct</span> <span style="color:#a6e22e">Metropolis_Hastings</span>{
    
    <span style="color:#75715e">//結果を格納する構造体
</span><span style="color:#75715e"></span>    Result result;

    <span style="color:#75715e">//サンプルを表す変数 
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">float</span> sample;
    <span style="color:#75715e">//ステップサイズの粒度を決定する変数
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">float</span> step_size;

    <span style="color:#75715e">//乱数生成エンジン
</span><span style="color:#75715e"></span>    rng_type rng;
    
    <span style="color:#75715e">//遷移の採択を決定する区間[0, 1]の一様分布に従う乱数
</span><span style="color:#75715e"></span>    uniform_real_distribution<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">float</span><span style="color:#f92672">&gt;</span>dist;
    <span style="color:#75715e">//確率的な摂動を表す区間[-1, 1]の一様分布に従う乱数
</span><span style="color:#75715e"></span>    uniform_real_distribution<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">float</span><span style="color:#f92672">&gt;</span>step;

    <span style="color:#75715e">/** コンストラクタ：各変数を初期化 */</span>
    Metropolis_Hastings(){

        result <span style="color:#f92672">=</span> Result();

        rng <span style="color:#f92672">=</span> rng_type(seed);
        dist <span style="color:#f92672">=</span> uniform_real_distribution<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">float</span><span style="color:#f92672">&gt;</span>(<span style="color:#ae81ff">0.0f</span>, <span style="color:#ae81ff">1.0f</span>);
        step <span style="color:#f92672">=</span> uniform_real_distribution<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">float</span><span style="color:#f92672">&gt;</span>(<span style="color:#f92672">-</span><span style="color:#ae81ff">1.0f</span>, <span style="color:#ae81ff">1.0f</span>);

        sample <span style="color:#f92672">=</span> dist(rng);
        step_size <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.5</span>;
    }

    <span style="color:#75715e">//Matropolis-Hastings法によるMCMCを実行する関数
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">mcmc</span>(){
        
        <span style="color:#75715e">//閾値の対数
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">float</span> log_thr;

        <span style="color:#75715e">//バーンインサンプリングを実行
</span><span style="color:#75715e"></span>        printf(<span style="color:#e6db74">&#34;mcmc: Start Burn in phase...</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
        <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> BURNIN_NUM; <span style="color:#f92672">++</span>i){
            <span style="color:#75715e">//確率的な摂動
</span><span style="color:#75715e"></span>            <span style="color:#66d9ef">float</span> delta <span style="color:#f92672">=</span> step_size <span style="color:#f92672">*</span> step(rng);
            <span style="color:#75715e">//遷移の候補点
</span><span style="color:#75715e"></span>            <span style="color:#66d9ef">float</span> candidate <span style="color:#f92672">=</span> sample <span style="color:#f92672">+</span> delta;
            <span style="color:#75715e">//閾値を計算
</span><span style="color:#75715e"></span>            log_thr <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.5f</span> <span style="color:#f92672">*</span> (pow2(sample) <span style="color:#f92672">-</span> pow2(candidate));
            <span style="color:#75715e">//遷移を採択するのか判定
</span><span style="color:#75715e"></span>            <span style="color:#66d9ef">if</span>(log(dist(rng)) <span style="color:#f92672">&lt;</span> log_thr){
                sample <span style="color:#f92672">=</span> candidate;
            }
        }

        <span style="color:#75715e">//サンプリングを実行
</span><span style="color:#75715e"></span>        printf(<span style="color:#e6db74">&#34;mcmc: Start Sampling phase...</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
        <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> SAMPLE_NUM; <span style="color:#f92672">++</span>i){
            <span style="color:#75715e">//確率的な摂動
</span><span style="color:#75715e"></span>            <span style="color:#66d9ef">float</span> delta <span style="color:#f92672">=</span> step_size <span style="color:#f92672">*</span> step(rng);
            <span style="color:#75715e">// 遷移の候補点
</span><span style="color:#75715e"></span>            <span style="color:#66d9ef">float</span> candidate <span style="color:#f92672">=</span> sample <span style="color:#f92672">+</span> delta;
            <span style="color:#75715e">//閾値の計算
</span><span style="color:#75715e"></span>            log_thr <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.5f</span> <span style="color:#f92672">*</span> (pow2(sample) <span style="color:#f92672">-</span> pow2(candidate));
            <span style="color:#75715e">//遷移を採択するのか判定
</span><span style="color:#75715e"></span>            <span style="color:#66d9ef">if</span>(log(dist(rng)) <span style="color:#f92672">&lt;</span> log_thr){
                sample <span style="color:#f92672">=</span> candidate;
            }
            <span style="color:#75715e">//結果の格納
</span><span style="color:#75715e"></span>            result.sample[i] <span style="color:#f92672">=</span> sample;
        }

        printf(<span style="color:#e6db74">&#34;mcmc: Done.</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);

        <span style="color:#75715e">//結果を保存
</span><span style="color:#75715e"></span>        result.dump();

        printf(<span style="color:#e6db74">&#34;mcmc: Finish dumping samples.</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
    }

};

<span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>(){
    Metropolis_Hastings model;
    model.mcmc();
    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
}
</code></pre></div></details>
<p>それでは実験結果を見ていきましょう．
得られたサンプル系列 $x_1,x_2,\cdots, x_{40000}$ のヒストグラムを示します．</p>
<p><img src="/image/Metropolis_Hastings_1.png" alt=""></p>
<p>図中赤線が，真の標準正規分布の確率密度関数を示します．
この結果を見ると，標準正規分布に従うサンプルが得られていることがわかりますね．</p>
<p>実験結果は<code>Python</code>の<code>matploylib</code>を用いて可視化しています．
以下に可視化に用いたコードを示します．</p>
<details>
<summary>plot.py</summary>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Python:plot.py" data-lang="Python:plot.py"><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
<span style="color:#f92672">from</span> matplotlib <span style="color:#f92672">import</span> pyplot <span style="color:#66d9ef">as</span> plt

<span style="color:#75715e"># 実験で得られたサンプリングを読み込む</span>
sample <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>load(<span style="color:#e6db74">&#34;result/sample.npy&#34;</span>)

<span style="color:#75715e"># 適当に区間をとる</span>
x <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linspace(<span style="color:#f92672">-</span><span style="color:#ae81ff">4.0</span>, <span style="color:#ae81ff">4.0</span>, <span style="color:#ae81ff">300</span>)
<span style="color:#75715e"># 標準正規分布の確率密度関数</span>
pdf <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>exp(<span style="color:#f92672">-</span><span style="color:#ae81ff">0.5</span> <span style="color:#f92672">*</span> x <span style="color:#f92672">*</span> x) <span style="color:#f92672">/</span> np<span style="color:#f92672">.</span>sqrt(<span style="color:#ae81ff">2.0</span> <span style="color:#f92672">*</span> np<span style="color:#f92672">.</span>pi)

<span style="color:#75715e"># 以下，実験結果の描写</span>
fig <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>figure(figsize <span style="color:#f92672">=</span> (<span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">4</span>), dpi <span style="color:#f92672">=</span> <span style="color:#ae81ff">300</span>)
ax <span style="color:#f92672">=</span> fig<span style="color:#f92672">.</span>add_subplot(<span style="color:#ae81ff">111</span>)
ax<span style="color:#f92672">.</span>grid()
ax<span style="color:#f92672">.</span>set_xlim(<span style="color:#f92672">-</span><span style="color:#ae81ff">4.0</span>, <span style="color:#ae81ff">4.0</span>)
ax<span style="color:#f92672">.</span>set_ylim(<span style="color:#ae81ff">0.0</span>, <span style="color:#ae81ff">0.45</span>)
ax<span style="color:#f92672">.</span>set_xlabel(<span style="color:#e6db74">&#34;$x$&#34;</span>, fontsize <span style="color:#f92672">=</span> <span style="color:#ae81ff">16</span>)
ax<span style="color:#f92672">.</span>set_ylabel(<span style="color:#e6db74">&#34;Probability Density&#34;</span>, fontsize <span style="color:#f92672">=</span> <span style="color:#ae81ff">16</span>)

<span style="color:#75715e"># 標準正規分布の確率密度関数の描写</span>
ax<span style="color:#f92672">.</span>plot(x, pdf, label <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Gaussian PDF&#34;</span>, color <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;red&#34;</span>, lw <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>, alpha <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.75</span>)
ax<span style="color:#f92672">.</span>legend(fontsize <span style="color:#f92672">=</span> <span style="color:#ae81ff">14</span>, loc <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>)

<span style="color:#75715e"># 得られたサンプルのヒストグラムを描写</span>
ax_ <span style="color:#f92672">=</span> ax<span style="color:#f92672">.</span>twinx()
ax_<span style="color:#f92672">.</span>hist(sample, bins <span style="color:#f92672">=</span> <span style="color:#ae81ff">100</span>, alpha <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.5</span>, range <span style="color:#f92672">=</span> (<span style="color:#f92672">-</span><span style="color:#ae81ff">4.0</span>, <span style="color:#ae81ff">4.0</span>))
ax_<span style="color:#f92672">.</span>set_ylabel(<span style="color:#e6db74">&#34;Frequency&#34;</span>, fontsize <span style="color:#f92672">=</span> <span style="color:#ae81ff">16</span>)
</code></pre></div></details>
<h3 id="まとめ">まとめ</h3>
<p>本記事ではメトロポリス法について解説しました．
また，数値実験ではメトロポリス法によるMCMCで，標準正規分布からのサンプリングを行い，確率密度関数とともに可視化することにより，サンプリングがうまくいっていることが確認できました．
記事内では，確率分布からのサンプリングを目的としてメトロポリス法，MCMCを用いましたが，これは氷山の一角です．
メトロポリス法やMCMCは，機械学習における回帰問題，分類問題，クラスタリング，などにも応用することが可能です．
というか，こちらの方が実用的ですし，面白いです．
機械学習への応用はまた別の記事で書き連ねようと思いますので，よろしくお願いいたします．</p>
<h5 id="参考文献参考記事">参考文献・参考記事</h5>
<p><a href="https://ja.wikipedia.org/wiki/%E3%83%A1%E3%83%88%E3%83%AD%E3%83%9D%E3%83%AA%E3%82%B9%E3%83%BB%E3%83%98%E3%82%A4%E3%82%B9%E3%83%86%E3%82%A3%E3%83%B3%E3%82%B0%E3%82%B9%E6%B3%95">Wikipedia：メトロポリス・ヘイスティングス法</a></p>

    </div>
</div><div id="social-media-share" class="has-text-centered">
	<p><i>Sharing is caring!</i></p>
	<br>
	
	<div class="share-buttons">
	    <a  href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fexample.com%2fposts%2fmetropolis_hastings%2f"
	        onclick="socialMediaPopUp(this.href, '', 500, 500); return false;"
	        title="Share on Facebook. Opens in a new window.">
	        <img src=/img/icons/45px/facebook.png>
	    </a>

	    <a  href="https://twitter.com/intent/tweet?text=%e3%83%a1%e3%83%88%e3%83%ad%e3%83%9d%e3%83%aa%e3%82%b9%e6%b3%95%e3%81%a3%e3%81%a6%e3%81%aa%e3%82%93%e3%81%a0%e3%81%97%e3%80%82&url=https%3a%2f%2fexample.com%2fposts%2fmetropolis_hastings%2f"
	        onclick="socialMediaPopUp(this.href, '', 500, 500); return false;"
	        title="Share on Twitter. Opens in a new window." >
	        <img src=/img/icons/45px/twitter.png>
	    </a>

		<a  href="http://www.reddit.com/submit?url=https%3a%2f%2fexample.com%2fposts%2fmetropolis_hastings%2f"
	        onclick="socialMediaPopUp(this.href, '', 900, 500); return false;"
	        title="Share on Reddit. Opens in a new window." >
	        <img src=/img/icons/45px/reddit.png>
	    </a>

	    <a  href="http://pinterest.com/pin/create/button/?url=https%3a%2f%2fexample.com%2fposts%2fmetropolis_hastings%2f"
	        onclick="socialMediaPopUp(this.href, '', 900, 500); return false;"
	        title="Share on Pinterest. Opens in a new window." >
	        <img src=/img/icons/45px/pinterest.png>
	    </a>

	    <a  href="http://www.tumblr.com/share/link?url=https%3a%2f%2fexample.com%2fposts%2fmetropolis_hastings%2f"
	        onclick="socialMediaPopUp(this.href, '', 900, 500); return false;"
	        title="Share on Tumblr. Opens in a new window." >
	        <img src=/img/icons/45px/tumblr.png>
	    </a>

		<a  href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fexample.com%2fposts%2fmetropolis_hastings%2f
			&title=%e3%83%a1%e3%83%88%e3%83%ad%e3%83%9d%e3%83%aa%e3%82%b9%e6%b3%95%e3%81%a3%e3%81%a6%e3%81%aa%e3%82%93%e3%81%a0%e3%81%97%e3%80%82&summary=%e6%9c%ac%e8%a8%98%e4%ba%8b%e3%81%a7%e3%81%af%ef%bc%8c%e3%83%9e%e3%83%ab%e3%82%b3%e3%83%95%e9%80%a3%e9%8e%96%e3%83%a2%e3%83%b3%e3%83%86%e3%82%ab%e3%83%ab%e3%83%ad%e6%b3%95%ef%bc%88Markov%20Chain%20Monte%20Carlo%3a%20MCMC%ef%bc%89%e3%82%92%e5%ae%9f%e7%8f%be%e3%81%99%e3%82%8b%e6%89%8b%e6%b3%95%e3%81%ae%ef%bc%91%e3%81%a4%e3%81%a7%e3%81%82%e3%82%8b%ef%bc%8c%e3%83%a1%e3%83%88%e3%83%ad%e3%83%9d%e3%83%aa%e3%82%b9%e6%b3%95%ef%bc%88Metropolis-Hastings%20Method%ef%bc%89%e3%81%ab%e3%81%a4%e3%81%84%e3%81%a6%e8%a7%a3%e8%aa%ac%e3%81%97%e3%81%a6%e3%81%bf%e3%81%be%e3%81%99%ef%bc%8e%20%e3%81%be%e3%81%9f%ef%bc%8c%e7%b0%a1%e5%8d%98%20of%20%e7%b0%a1%e5%8d%98%e3%81%aa%e6%95%b0%e5%80%a4%e5%ae%9f%e9%a8%93%e3%82%92%e8%a1%8c%e3%81%84%e3%81%be%e3%81%99%ef%bc%8e%0a%e3%83%a1%e3%83%88%e3%83%ad%e3%83%9d%e3%83%aa%e3%82%b9%e6%b3%95%28Metropolis-Hastings%20Method%29%20%e6%95%b0%e5%80%a4%e5%ae%9f%e9%a8%93%20%e4%bb%8a%e5%9b%9e%e3%81%af%e3%83%a1%e3%83%88%e3%83%ad%e3%83%9d%e3%83%aa%e3%82%b9%e6%b3%95%e3%81%ab%e3%82%88%e3%82%8b1%e6%ac%a1%e5%85%83%e6%a8%99%e6%ba%96%e6%ad%a3%e8%a6%8f%e5%88%86%e5%b8%83%e3%81%8b%e3%82%89%e3%81%ae%e3%82%b5%e3%83%b3%e3%83%97%e3%83%aa%e3%83%b3%e3%82%b0%e3%82%92%e8%a1%8c%e3%81%84%e3%81%be%e3%81%99%ef%bc%8e%20%e7%a2%ba%e7%8e%87%e5%a4%89%e6%95%b0%e3%82%92%20%24x%5cin%5cmathbb%20R%24%20%e3%81%a8%e3%81%97%e3%81%be%e3%81%99%ef%bc%8e%20%e6%a8%99%e6%ba%96%e6%ad%a3%e8%a6%8f%e5%88%86%e5%b8%83%e3%81%ae%e7%a2%ba%e7%8e%87%e5%af%86%e5%ba%a6%e9%96%a2%e6%95%b0%20%24p%28x%29%24%20%e3%81%af%0a%24%24%20p%28x%7c%5cmu%20%3d%200%2c%20%5csigma%5e2%20%3d%201%29%20%3d%20%5cfrac%7b1%7d%7b%5csqrt%7b2%5cpi%7d%7d%5cexp%5cleft%28-%5cfrac%7b1%7d%7b2%7dx%5e2%5cright%29%2c%20%24%24%0a%e3%81%a8%e3%81%aa%e3%82%8a%e3%81%be%e3%81%99%ef%bc%8e%20%e7%8f%be%e6%99%82%e7%82%b9%e3%81%a7%e3%81%ae%e3%82%b5%e3%83%b3%e3%83%97%e3%83%ab%e3%82%92%20%24x%24%20%e3%81%a8%e3%81%97%ef%bc%8c%e7%a2%ba%e7%8e%87%e7%9a%84%e6%91%82%e5%8b%95%20%24%5cdelta%5cin%5cmathbb%20R%24%20%e3%82%92%e5%8a%a0%e3%81%88%e3%81%9f%ef%bc%8c%e9%81%b7%e7%a7%bb%e5%85%88%e3%81%ae%e5%80%99%e8%a3%9c%e7%82%b9%e3%82%92%20%24x%27%20%3d%20x%20%2b%20%5cdelta%24%e3%81%a8%e3%81%97%e3%81%be%e3%81%99%ef%bc%8e%20%e3%83%a1%e3%83%88%e3%83%ad%e3%83%9d%e3%83%aa%e3%82%b9%e6%b3%95%e3%81%ae%e6%9b%b4%e6%96%b0%e5%89%87%e3%81%a8%e3%81%97%e3%81%a6%ef%bc%8c%24x%2cx%27%24%20%e3%82%92%e7%94%a8%e3%81%84%e3%81%a6&source=rafed123.github.io"
	        onclick="socialMediaPopUp(this.href, '', 900, 500); return false;"
	        title="Share on LinkedIn. Opens in a new window." >
	        <img src=/img/icons/45px/linkedin.png>
	    </a>

	    <a  href="mailto:?subject=%e3%83%a1%e3%83%88%e3%83%ad%e3%83%9d%e3%83%aa%e3%82%b9%e6%b3%95%e3%81%a3%e3%81%a6%e3%81%aa%e3%82%93%e3%81%a0%e3%81%97%e3%80%82&amp;body=Check out this site https%3a%2f%2fexample.com%2fposts%2fmetropolis_hastings%2f"
	        title="Share via Email. Opens in a new window." >
	        <img src=/img/icons/45px/mail.png>
	    </a>
	</div>
</div>


<br>
<div id="disqus_thread"></div>
<script type="text/javascript">
    (function () {
        
        
        if (window.location.hostname == "localhost")
            return;

        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        var disqus_shortname = '';
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


        </div>
    </div>

<footer class="footer has-background-dark">
    <div class="content has-text-centered has-text-white">
        <p>
            © 2020 Ramium. Powered by
            <a class="has-text-light" href="https://github.com/gohugoio/hugo" target="_blank">
            Hugo</a>. Theme
            <a class="has-text-light" href="https://github.com/rafed123/ramium/" target="_blank">
                Ramium.
            </a>
        </p>
    </div>
</footer>
</body>

</html>